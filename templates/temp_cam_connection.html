<!-- temp_cam_connection.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Handy Camera Stream</title>
</head>
<body>
<h2>Handy Camera Streaming</h2>
<video id="localVideo" autoplay muted playsinline></video>
better version
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
<script>
const socket = io();
const video = document.getElementById("localVideo");

navigator.mediaDevices.getUserMedia({ video: true, audio: false })
.then(stream => {
    video.srcObject = stream;

    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    setInterval(() => {
        if (video.readyState === video.HAVE_ENOUGH_DATA) {
            // Reduce resolution for better performance
            const scale = 0.5;
            canvas.width = video.videoWidth * scale;
            canvas.height = video.videoHeight * scale;

            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

            // Lower quality to 0.3
            canvas.toBlob(blob => {
                if(blob) {
                    socket.emit("frame", blob);
                }
            }, "image/jpeg", 0.3);
        }
    }, 66); // ~15 FPS
});
</script>
</body>
</html>
