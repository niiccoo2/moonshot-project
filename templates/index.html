<!DOCTYPE html>
<html>
<head>
  <title>Catch Game Input</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>

<video id="video" autoplay playsinline></video>
<canvas id="canvas" width="320" height="240" style="display:none"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const socket = io();

navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => video.srcObject = stream);

setInterval(() => {
    ctx.drawImage(video, 0, 0, 320, 240);
    canvas.toBlob(blob => {
        socket.emit("frame", blob);
    }, "image/jpeg", 0.5);
}, 66); // ~15 fps

socket.on("result", data => {

    console.log(data);

});
</script>

</body>
</html>
